<?xml version="1.0"?>

<template title="Example" orientation="portrait" format="210x297" unit="mm" query-standard="sql" size="10">
  <title query="select usename from pg_user where usename=CURRENT_USER">#{title.usename}</title>
  <infos>
    <info type="created-on">04/09/2008</info>
  </infos>
  <loop name="loop0">
    <block name="title">
      <text x="5" y="2" width="200" height="250" align="C" size="24">The Book of Xil</text>
    </block>
    <page-break/>
    <block type="header" mode="even">
      <text x="2" y="2" width="206" height="5" align="L">Facture EVEN {KEY}</text>
      <image x="160" y="10" width="50" height="50" src="/usr/share/gnome/help/gnomine/fr/figures/easy-hints-1.png"/>
    </block>
    <block type="header" mode="odd">
      <image x="160" y="1" width="20" height="25" src="/usr/share/gnome/help/gnomine/fr/figures/easy-hints-2.png"/>
      <text x="2" y="2" width="206" height="15" radius="2" align="R">Facture ODD</text>
      <image x="2" y="10" width="50" height="50" src="/usr/share/gnome/help/gnomine/fr/figures/easy-hints-1.png"/>
    </block>
    <block type="footer">
      <line x1="2" y1="0" x2="208" y2="55" border-color="#F00" />
      <line x1="2" y1="55" x2="208" y2="0"/>
      <text x="2" y="2" width="206" height="5" align="C">Facture FOOTER {PAGENO}/{PAGENB}</text>
      <image x="2" y="10" width="50" height="50" src="/usr/share/gnome/help/gnomine/fr/figures/easy-hints-2.png"/>
    </block>
    <block name="toc">
      <text x="5" y="2" width="200" height="20" align="C" size="18">@@TOC@@Table des matières</text>
    </block>
    <loop name="toc" query="SELECT usename, usesuper, usesysid FROM pg_user">
      <block height="7">
        <text x="10"  y="1" width="100" height="5" align="L">#{toc.usename}</text>
        <text x="110" y="1" width="80" height="5"  align="R">p.[[sect#{toc.usesysid}]]</text>
      </block>
    </loop>
    <page-break/>
    <loop name="loop1" query="SELECT usename, usesuper, usesysid FROM pg_user">
      <block type="header">
        <text x="2" y="2" width="206" height="5" align="C">Utilisateur #{loop1.usename}</text>
        <text x="2" y="2" width="206" height="5" align="L">Test {LOCAL:test} {LOCAL}</text>
      </block>
      <block name="ligne de facture" if="#{loop1.usename}!='postgres'">
        <text x="2" y="2" width="100" height="5" align="C">@@sect#{loop1.usesysid}@@Blabla, ceci est son ID système : #{loop1.usesysid}</text>
        <text x="2" y="20" width="100" height="5" align="L" if="#{loop1.usesuper}" decoration="underline">C'est un superutilisateur</text>
        <text x="2" y="40" width="100" height="5" align="C">Blabla on est le {CURRENT_DATE} et plus précisément le {CURRENT_TIMESTAMP}</text>
        <text x="2" y="60" width="100" height="5" align="R" style="italic">Dernier bloc page [[last_block]]</text>
        <line x1="2" y1="80" x2="208" y2="81" height="1"/>
      </block>
      <loop name="loop2" query="SELECT schemaname,tablename FROM pg_tables WHERE tableowner=#{loop1.usename}" if="#{loop1.usename}!='postgres'">
        <block name="details">
          <text x="2" y="2" width="100" height="5" align="C">#{loop2.schemaname}.#{loop2.tablename}.#{loop1.usesysid}</text>
        </block>
      </loop>
      <block name="ligne de facture2" if="#{loop1.usename}!='postgres'">
        <text x="2" y="2" width="100" height="5" align="C">[[last_block]], ceci est son ID système : #{loop1.usesysid}</text>
        <text x="50" y="20" width="100" height="5" align="L" if="#{loop1.usesuper}" decoration="underline">C'est un superutilisateur</text>
        <text x="150" y="40" width="100" height="5" align="C">Blabla on est le {CURRENT_DATE:%e %B %Y} et plus précisément le {CURRENT_TIMESTAMP:%e %B %Y à %H:%M}</text>
        <line x1="2" y1="80" x2="208" y2="81" height="1"/>
      </block>
    </loop>
    <page-break/>
    <block name="recap">
      <text x="2" y="2" width="100" height="5" align="C" color="#F40" weight="bold" decoration="underline" style="italic" size="18">Un bon exemple</text>
      <text x="2" y="20" width="100" height="5" align="C">Blabla @@last_block@@ </text>
      <line x1="2" y1="40" x2="208" y2="41" height="1" color="#1245EF"/>
      <rectangle x="20" y="60" width="170" height="50" border-width="2" border-color="#04F" background-color="#FFD" radius="15"/>
      <line x1="2" y1="0" x2="208" y2="1"/>
    </block>
  </loop>
</template>
 
