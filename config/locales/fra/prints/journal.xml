<?xml version="1.0"?>
<template title="Example" lang="fr" version="2.0">
   <infos>
    <info name="authors">Brice Texier</info>
  </infos>
  <parameters>
    <parameter name="journal" nature="journal"/>
    <parameter name="started_on" nature="date"/>
    <parameter name="stopped_on" nature="date"/>
  </parameters>
  <document unit="mm" size="10" title="journal.name">
    <page orientation="portrait" format="A4" margin="10mm">
      <part height="30mm">
	<set>
          <image value="{{journal.company.entity/photo}}" height="30mm">
            <text value="{{journal.company.entity/full_name}}" size="16"/>
          </image>
	</set>
      </part>
      <part height="14mm">
	<set>
	  <text value="{{journal.name}}" left="50%" align="center" width="150mm" bold="true" size="12"/>
	  <text value="Du {{started_on?format=month_letter}} au {{stopped_on?format=month_letter}} ({{journal/currency}})" left="50%" align="center" width="150mm" top="7mm" size="12"/>
	</set>
      </part>
      
      <!-- Array of entries of the journal for the matching period -->
      <table collection="journal.entry_lines_between(started_on, stopped_on)" fixed="true">
	<column label="Date" property="entry/printed_on" width="19mm"/>
	<column label="Numéro" property="entry/number" width="24mm" align="left"/>
	<column label="Libellé de l'écriture" property="name" width="87mm"/>
	<column label="N°Compte" property="account/number" width="20mm"/>
	<column label="Débit" property="original_debit" width="20mm" numeric="money"/>
	<column label="Crédit" property="original_credit" width="20mm" numeric="money"/>
      </table>
      
      <!-- Sum -->
      <part height="14mm">
        <set left="130mm">
          <text value="Totaux" top="0.5mm" left="19mm" align="right" bold="true"/>
          <text value="{{journal.entry_lines_calculate(:debit, started_on, stopped_on)?numeric}}" top="0.5mm" left="39.5mm" align="right" bold="true"/>
          <text value="{{journal.entry_lines_calculate(:credit, started_on, stopped_on)?numeric}}" top="0.5mm" left="59.5mm" align="right" bold="true"/>
          <text value="Solde" top="4.5mm" left="19mm" align="right" bold="true"/>
          <text value="{{journal.entry_lines_calculate(:balance, started_on, stopped_on)?numeric}}" top="4.5mm" left="40mm" align="center" bold="true"/>
          <rectangle width="60mm" height="4mm" border="0.5 solid #000"/>
          <rectangle width="60mm" height="4mm" border="0.5 solid #000" top="4mm"/>
          <line path="20mm,0 ; 20mm,8mm" border="0.5 solid #000"/>
          <line path="40mm,0 ; 40mm,4mm" border="0.5 solid #000"/>
        </set>
      </part>
         
    </page>
    
  </document>
</template>
