<?xml version="1.0"?>
<template title="Example" lang="fr" version="2.0">
  <infos>
    <info name="authors">Thibaud Mérigon, Brice Texier</info>
  </infos>
  <parameters>
    <parameter name="transport" nature="transport">Bon transporteur</parameter>
  </parameters>
  <document unit="mm" size="10" title="transport">
    <page orientation="portrait" format="A4" margin="10mm">
           
      <part height="30mm">
	<set>
	  <text value="Expéditeur" align="left" />
	  <text value="{{Entity.of_company.default_mail_address/mail_coordinate}}" top="4mm" align="left" bold="true"/>
	  <text value="Transporteur" left="95mm"/>
	  <text value="{{transport.transporter.default_mail_address/mail_coordinate}}"  top="4mm" left="95mm" bold="true"/>
	</set>
      </part>

      <part height="14mm">
	<set top="1mm">
	  <text value="Poids total (kg) : {{transport.deliveries.first.mass}}"/>
	  <text value="Date d'expédition : {{transport/transport_on?format=month_letter}}" top="4mm"/>
	  <text value="Nombre de colis : {{transport.deliveries.first/parcel_sum}}" top="8mm" />
	</set>
      </part>

      <iteration variable="delivery" collection="transport.deliveries">
        <part height="26mm">
          <set top="3mm">
            <rectangle width="29mm" height="13mm" top="10mm"  border="0.5 solid #555"/> 
            <text value="{{delivery.number}}" font="helvetica" size="10" align="center" left="14.5mm" top="11mm"/>
            <text value="Destinataire :"/>
            <rectangle width="65mm" height="23mm" left="30mm" border="0.5 solid #555"/> 
	    <text value="{{delivery/address}}" top="1mm" left="31mm" size="9" bold="true"/>
            <rectangle width="94mm" height="23mm" left="96mm" border="0.5 solid #555"/> 
	  </set>
        </part>
	<table collection="delivery.items">
	  <column label="Quantité" property="quantity" width="20mm"/>
	  <column label="Unité" property="unit.name" width="10mm"/>
	  <column label="Produit" property="product.name" width="160mm"/>
	  <!--<column label="Lot" property="tracking.name" width="40mm"/>-->
	</table>
      </iteration>

    </page>
  </document>
</template>

