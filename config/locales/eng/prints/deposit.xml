<?xml version="1.0"?>
<template title="Deposit" lang="en" version="2.0">
  <infos>
    <info name="authors">Thibaud Mérigon, Brice Texier</info>
  </infos>
  <parameters>
    <parameter name="deposit" nature="deposit">Deposit</parameter>
  </parameters>
  <document unit="mm" size="10" title="client.label">
    <page format="A4" margin="10mm">
      <part height="85mm">
        <set>
          <image value="{{Entity.of_company/photo}}" height="30mm">
            <text value="{{Entity.of_company/full_name}}" size="16"/>
          </image>
          <text value="{{deposit.cash/bank_name}}" bold="true" align="left" font="helvetica" top="42mm" left="100mm"/>
          <text value="{{deposit.cash/address}}" align="left" font="helvetica" top="46mm" left="100mm"/>
          <line path="195mm,85mm ; 210mm,85mm" border="0.5 solid #000"/>
        </set>
      </part>

      <part height="15mm"> 
        <set left="50%"> 
          <text value="Remise en banque du {{deposit.created_on?format=classic}}" top="1mm" bold="true" size="12" align="center"/>
          <text value="À remettre sur le compte {{deposit.cash/iban_label}}" top="6mm" align="center" if="deposit.cash.mode == 'iban'"/>
          <text value="À remettre sur le compte {{deposit.cash/bank_code}}-{{deposit.cash/agency_code}}-{{deposit.cash/number}}-{{deposit.cash/key}}" top="6mm" align="center" if="deposit.cash.mode == 'bban'"/>
        </set>
      </part>

      <table collection="deposit.payments" fixed="true">
        <column label="Client" property="payer.full_name" width="75mm"/>
        <column label="Bank" property="bank" width="35mm"/>
        <column label="Compte Nb" property="account_number" width="25mm" align="center"/>
        <column label="Check Nb" property="check_number" width="15mm" align="center"/>
        <column label="Date" property="paid_on" width="20mm" align="center"/>
        <column label="Amount" property="amount" width="20mm" align="right" numeric="money"/>
      </table>
  
      <part height="10mm">
        <set left="50%" top="3mm">
          <text value="{{deposit/payments_count}} payments: {{deposit/amount?numeric}}€" size="12" bold="true" align="center"/>
        </set>
      </part>

<!--
      <part height="35mm">
        <set left="100mm" top="3mm">
          <rectangle width="80mm" height="30mm"/>
          <text value="Cachet et/ou signature" top="2mm" left="2mm"/>
        </set>
      </part>
-->

      <part height="15mm" bottom="true">
        <set>
          <line path="0,1mm ; 100%,1mm" border="0.5 solid #000"/>
          <set top="2.5mm"> 
            <text value="Deposit #{{deposit/number}}" size="10" align="left"/>
            <text value="{{deposit/created_on?format=month_letter}}" size="10" right="0" align="right"/>
            <text value="{{Entity.of_company/full_name}} - SIREN {{Entity.of_company/siren}}" size="8" left="50%" align="center" top="6mm"/>
            <text value="{{Entity.of_company.default_mail_address/coordinate}}" size="8" left="50%" align="center" top="9.5mm"/>
          </set>
        </set>
      </part>

    </page>
  </document>
</template>
