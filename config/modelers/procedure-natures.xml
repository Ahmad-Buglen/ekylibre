<?xml version="1.0" encoding="UTF-8"?>
<procedure-natures xmlns="http://www.ekylibre.org/XML/2013/product-natures">
  <procedure-nature name="wheat-crop">
    <name xml:lang="fra">Culture de blé annuelle</name>
    <name xml:lang="eng">Annual wheat crop</name>
    <description xml:lang="fra" source="internal">Procédure modèle permettant de décrire les opérations successives pour cultiver une sole annuelle de produit végétaux</description>
    <parameters>
      <parameter name="activity" type="activity" nature="production">
	<name xml:lang="fra">Activité</name>
      </parameter>
      <parameter name="campaign" type="campaign">
	<name xml:lang="fra">Campagne</name>
      </parameter>
      <parameter name="land_parcel" type="land-parcel" properties="producible" pre-indicators-state="production::empty">
	<name xml:lang="fra">Parcelle</name>
      </parameter>
      <parameter name="manure" type="matter" nature="manure" variety="organic-matter">
	<name xml:lang="fra">Fumier</name>
      </parameter>
      <parameter name="seeds" type="matter" nature="seed" variety="wheat">
	<name xml:lang="fra">Semence</name>
      </parameter>
      <parameter name="fertilizer" type="matter" nature="fertilizer" variety="mineral-matter">
	<name xml:lang="fra">Engrais</name>
      </parameter>
      <parameter name="herbicide" type="matter" nature="phytosanitary" variety="herbicide">
	<name xml:lang="fra">Herbicide</name>
      </parameter>
      <parameter name="fungicide" type="matter" nature="phytosanitary" variety="fungicide">
	<name xml:lang="fra">Fongicide</name>
      </parameter>
      <parameter name="grains" type="matter" nature="--" variety="[seeds]">
	<name xml:lang="fra">Grain de blé</name>
      </parameter>
      <parameter name="straw" type="matter" nature="--" variety="[seeds]">
	<name xml:lang="fra">Paille de blé</name>
      </parameter>
      <parameter name="culture" type="vegetal" nature="crop" variety="vegetal">
	<name xml:lang="fra">Sole de blé</name>
      </parameter>
      <parameter name="spreader" abilities="spreader">
	<name xml:lang="fra">Épandeur</name>
      </parameter>
    </parameters>
    <conditions>
      <condition>in=[activity] and [campaign]</condition>
    </conditions>
    <operations>
      <operation name="fertilizing" required="false" working-set="organic-fertilization">
	<tasks>
	  <task do="[spreader] moves-to [land_parcel]"/>
	  <task do="[spreader] acts-on [land_parcel]"/>
	  <task do="[land_parcel] consumes [manure]"/>
	</tasks>
      </operation>
      <operation name="plowing" required="true" target="[land_parcel].indicator(ground-appearance) == raw" working-set="soil-working">
	<tasks>
	  <task do="working-set moves-to [land_parcel]"/>
	  <task do="working-set acts-on [land_parcel]"/>
	  <task do="[driver] measure [land_parcel] at ground-appearance"/>
	</tasks>
      </operation>
      <operation name="surperficial-plowing" required="true" target="[land_parcel].indicator(sowable) == true" working-set="soil-working">
	<tasks>
	  <task do="working-set moves-to [land_parcel]"/>
	  <task do="working-set acts-on [land_parcel]"/>
	  <task do="[land_parcel] is-measured-at on indicators.sowable"/>
	</tasks>
      </operation>
      <operation name="sowing" required="true" target-indicators-state="production::sown" working-set="sowing">
	<tasks>
	  <task do="[sowing] moves-to [land_parcel]"/>
	  <task do="[sowing] acts-on [land_parcel]"/>
	  <task do="[culture] consume [seeds]"/>
	  <task do="[sowing] modify [land_parcel] on indicators.production"/>
	  <task do="[land_parcel] produce [culture](quantity::?, unit::?, variety::[seeds].variety)"/>			
	</tasks>
      </operation>
      <operation name="fertilizing" required="true" working-set="mineral-fertilization">
	<tasks>
	  <task do="working-set moves-to [culture]"/>
	  <task do="working-set acts-on [culture]"/>
	  <task do="[culture] consumes [fertilizer]"/>
	</tasks>
      </operation>
      <operation name="treating" required="false" working-set="chemical-treatment">
	<tasks>
	  <task do="working-set moves-to [culture]"/>
	  <task do="working-set acts-on [culture]"/>
	  <task do="[culture] consumes [herbicide]"/>
	</tasks>
      </operation>
      <operation name="treating" required="false" working-set="phytosanitary-treatment">
	<tasks>
	  <task do="working-set moves-to [culture]"/>
	  <task do="working-set acts-on [culture]"/>
	  <task do="[culture] consumes [fungicide]"/>
	</tasks>
      </operation>
      <operation name="seed-harvest" required="true" working-set="harvest">
	<tasks>
	  <task do="working-set moves-to [culture]"/>
	  <task do="working-set acts-on [culture]"/>
	  <task do="[culture] produce [grains](quantity::?, unit::?, variety::[culture].variety)"/>
	  <task do="[culture] produce [straw](quantity::?, unit::?, variety::[culture].variety)"/>			
	</tasks>
      </operation>
      <operation name="seed-transport" required="true" working-set="transport">
	<tasks>
	  <task do="working-set moves-to [grains]"/>
	  <task do="working-set catches [grains]"/>
	  <task do="[grains] moves-to [l2]"/>
	</tasks>
      </operation>
    </operations>
  </procedure-nature>
</procedure-natures>
