<?xml version="1.0"?>
<procedures xmlns="http://www.ekylibre.org/XML/2013/procedures">
  <procedure name="animal_treatment" natures="animal_curative_medicine_admission" version="0">
    <variables>
      <variable name="animal" variety="animal" roles="animal_curative_medicine_admission-target"/>
      <variable name="animal_medicine" abilities="care(animal)" roles="animal_curative_medicine_admission-input_origin"/>
      <variable name="animal_medicine_to_give" variety=":animal_medicine" derivative-of=":animal_medicine" new="parted-from: animal_medicine" roles="animal_curative_medicine_admission-input" default-name="{{variant}} [{{birth_day}}/{{birth_month}}/{{birth_year}}] ({{container}})">
        <handler indicator="population"/>
        <handler indicator="net_mass" unit="gram" if="animal_medicine.net_mass(gram) &gt; 0" to="population" backward="(value * self..net_mass(gram))" forward="(value / self..net_mass(gram))"/>
        <handler indicator="net_volume" unit="milliliter" if="animal_medicine.net_volume(milliliter) &gt; 0" to="population" backward="(value * self..net_volume(milliliter))" forward="(value / self..net_volume(milliliter))"/>
      </variable>
      <variable name="caregiver" abilities="administer_care(animal)" roles="animal_curative_medicine_admission-doer"/>
    </variables>
    <operations>
      <operation id="1">
        <!-- Operation 100 -->
        <task do="[caregiver] moves at [animal]"/>
        <task do="[caregiver] measures [animal|healthy]"/>
        <!-- Operation 200 (10 minutes) -->
        <task do="[caregiver] moves at [animal_medicine]"/>
        <task do="[animal_medicine] parts with [animal_medicine_to_give]"/>
        <task do="[animal_medicine_to_give] moves in [caregiver]"/>
        <!-- Operation 300 -->
        <task do="[caregiver] moves at [animal]"/>
        <task do="[animal] consumes [animal_medicine_to_give]"/>
      </operation>
    </operations>
  </procedure>
</procedures>
