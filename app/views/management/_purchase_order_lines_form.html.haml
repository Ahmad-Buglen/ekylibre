=formalize do |f|
  -f.error :purchase_order_line
  -f.field :purchase_order_line, :product_id,:choices=>@current_company.available_products.collect{|x| [x.name, x.id]}, :new=>{:action=>:products_create}
  -f.field :purchase_order_line, :amount, :choices=>@prices_amount
  -f.field :purchase_order_line, :quantity
=javascript_tag("function update_price(value) {new Ajax.Request('/management/find_price', {asynchronous:true, evalScripts:true, parameters:'product_id=' + encodeURIComponent(value), onSuccess: function(resp) {$('purchase_order_line_amount').update(resp.responseText);   }  }); }; /*update_price($('purchase_order_line_product_id').value); */")
=observe_field "purchase_order_line_product_id", :url=>{:action => :find_price}, :frequency => 0.25, :function=>"update_price(value)"
