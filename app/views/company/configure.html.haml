=form_tag(nil, {:class=>"vbox flex", :style=>'overflow:none'}) do
  .fields.flex
    -if @my_company.preferences.find(:all, :conditions=>["record_value_type = 'Sequence' AND record_value_id IS NULL"]).size > 0
      =toolbar do |t|
        -t.link :sequences_load
    =formalize do |f|
      -f.error 'my_company'
      -f.title tc(:general)
      -f.field :my_company, :name
      -f.field Company.human_attribute_name("code"), content_tag(:strong, @my_company.code)
      -f.field Company.human_attribute_name("entity_id"), link_to(@my_company.entity.full_name, {:controller=>:relations, :action=>:entity_update, :id=>@my_company.entity_id})
      -f.field :my_company, :sales_conditions, :field=>:textarea, :options=>{:cols=>60, :rows=>8}
      -for name, options in @tree
        -f.title tc(name)
        -for key in options.keys.sort
          -f.field t("preferences."+key), {:datatype=>options[key][:nature].to_sym, :model=>options[key][:model], :value=>options[key][:value], :name=>"preference[#{key}][value]"}
    .end
  .actions
    =submit_tag tg(:update)
    =link_to tg(:cancel), :back
 
