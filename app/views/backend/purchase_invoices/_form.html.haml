= field_set do
  = f.referenced_association :supplier, source: :suppliers, new: { supplier: 1 }
  = f.referenced_association :delivery_address, source: :own_mails, new: {entity_id: Entity.of_company.id}
  = f.association :nature, as: :hidden
  = f.input :reference_number
  = f.input :invoiced_at
  = f.input :payment_delay
  = f.input :tax_payability, as: :radio_buttons
  = f.referenced_association :responsible, source: :employees, new: { employed: 1 }
  = f.input :description
  = f.custom_fields

= field_set Purchase.human_attribute_name(:items) do
  .items
    %table#items-table
      %thead
        %tr
          %th= PurchaseItem.human_attribute_name(:variant)
          %th= Parcel.human_attribute_name(:number) if f.object.parcels.any?
          %th= PurchaseItem.human_attribute_name(:quantity)
          %th= PurchaseItem.human_attribute_name(:unit_pretax_amount)
          %th= PurchaseItem.human_attribute_name(:tax)
          %th= PurchaseItem.human_attribute_name(:reduction_percentage)
          %th= PurchaseItem.human_attribute_name(:pretax_amount)
          %th= PurchaseItem.human_attribute_name(:currency)
          %th
      - precision = Nomen::Currency[f.object.currency].precision

= f.attachments_field_set
