= field_set do
  = f.referenced_association :activity, :source => :main
  = f.referenced_association :campaign, :source => :currents
  = f.referenced_association :variant
  = f.referenced_association :support_variant
  = f.input :static_support, :show => :supports
  = f.input :state, as: :radio_buttons
  = f.input :started_at
  = f.input :stopped_at
  = f.input :working_indicator
  = f.input :working_unit
  = f.custom_fields

= field_set(:budgets) do
  %table
    %tr
      %td
        = :void
      = f.backend_fields_for :supports do |support_form|
        = render 'support_fields', f: support_form
      %td
        = link_to_add_association :add_support, f, :supports, partial: 'support_fields'
    %tr
      %td{colspan: '100%'}
        = f.input :homogeneous_expenses, wrapper: :nested
        = :expenses
    = f.backend_fields_for :budgets, show: :expenses
    %tr
      %td
        = link_to_add_association :add_expense, f, :budgets, partial: 'budget_fields', data:{association_insertion_node: 'this'}
    %tr
      %td{colspan: '100%'}
        = f.input :homogeneous_revenues, wrapper: :nested
        = :revenues
    = f.backend_fields_for :budgets, show: :revenues do |revenue_form|
      = render 'budget_fields', f: revenue_form
    %tr
      %td
        = link_to_add_association :add_revenue, f, :budgets, partial: 'budget_fields', data:{association_insertion_node: 'this'}
