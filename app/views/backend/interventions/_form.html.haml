- if Procedo[params[:procedure]]
  = field_set do
    = f.input :procedure, as: :hidden
    = f.referenced_association :production
  - if f.object.errors.count > 0
    = f.object.errors.messages.inspect


- else # Root Procedure Natures
  :ruby
    natures = []
    nature = Nomen::ProcedureNatures[params[:procedure_nature]]
    natures += (nature ? nature.children : Nomen::ProcedureNatures.roots)
    natures.delete_if{|n| Procedo.procedures_of_nature_and_its_children(n.name).empty?}

  .proposal-list
    - if natures.any?
      - for n in natures
        - procedures = Procedo.procedures_of_nature(n.name.to_sym)
        - if procedures.size == 1
          - procedure = procedures.first
          = link_to(procedure.human_name, {procedure: procedure.name}, class: "btn")
        - else
          = link_to(n.human_name, {procedure_nature: n.name}, class: "btn btn-important")
    - if nature
      - procedures = Procedo.procedures_of_nature(nature.name.to_sym)
      - if procedures.any?
        - for procedure in Procedo.procedures_of_nature(nature.name.to_sym)
          = link_to(procedure.human_name, {procedure: procedure.name}, class: "btn")
