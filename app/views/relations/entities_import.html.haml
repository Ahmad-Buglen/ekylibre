-form_tag({:id=>@step}, :multipart=>true, :style=>'overflow:none', :flex=>1, :orient=>:vertical) do
  .fields{:flex=>10}
    -if @step == :upload
      =formalize do |f|
        -f.field tc('upload'), file_field_tag(:upload)
        -#f.field tc('first_line_as_title'), check_box_tag(:first_line_as_title)
        -f.field tc('file_nature'), select_tag(:nature, options_for_select(@formats))
    -elsif @step == :columns
      -params[:columns] ||= {}
      =formalize do |f|
        -@columns.each_index do |index|
          -#+" "+content_tag(:div, @first_line[index], :class=>:note)
          -f.field @columns[index], select_tag("columns[#{index}]", options_for_select(@options, params[:columns][index.to_s]||(@options.detect{|x| x[0].match(/#{@columns[index]}/)}[1] rescue nil)))+" "+content_tag(:span, @first_line[index], :class=>:note)
    .end
  .actions
    =submit_tag(tc(:import))
 
