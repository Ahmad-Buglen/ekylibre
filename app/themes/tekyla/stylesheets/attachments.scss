$preview-modal-width: 80vw;
$preview-modal-height: 80vh;

$preview-modal-v_padding: 1vh;
$preview-modal-h_padding: 1vw;

$attachment-panel-height: 35px;

$attachment-files-padding: 5px;


$attachment-full-panel-height: 200px;
$attachment-full-file-height: $attachment-full-panel-height - $attachment-files-padding * 2;
$attachment-full-file-width: $attachment-full-file-height;

$attachment-file-width: $attachment-full-file-width;

$attachment-files-height: $attachment-panel-height - $attachment-files-padding * 2;

$attachment-body-file-padding: 3px;

$border: 1px solid #DDD;

.failed {
  color: red;
}

.attachments {
  min-height: $attachment-panel-height;

  .attachments-body {

    display: table;
    width: 100%;

    .attachments-upload {
      i {
        @include is-icon($fs-normal);
        @include use-icon(paperclip);
      }
      background: transparent;
      height: $attachment-panel-height;
      line-height: $attachment-panel-height;
      text-align: center;
      vertical-align: top;
      display: table-cell;
      position: relative;
      border: none;
      min-width: 3%;
      &, * {
        color: $link-color;
      }
      input[type='file'] {
        position: absolute;
        top: 0;
        right: 0;
        margin: 0;
        opacity: 0;
        overflow: hidden;
        cursor: pointer;
        line-height: $attachment-panel-height;
      }
    }

    .attachment-btns {
      display: table-cell;
      width: 3%;
      vertical-align: top;
      *[data-attachments-expand] {
        background: transparent;
        position: relative;
        overflow: hidden;
        display: inline-block;

        float: right;
        height: $attachment-panel-height;
        padding: 0;
        width: 100%;
        box-sizing: border-box;

        border: none;
        box-shadow: none;

        i {
          @include is-icon($fs-normal);
          @include use-icon(expand);
          color: $link-color;
        }
      }

    }

    .attachment-files {
      display: inline-block;
      min-height: $attachment-files-height;
      width: 96%;
      padding: $attachment-files-padding;
      position: relative;
      // box-shadow: inset 0 1px 3px #CCC;

      z-index: 0;

      &.hover {
        // box-shadow: 0 0 8px rgba(104, 142, 216, 0.8);
      }
      .attachment-files-placeholder {
        color: #CCC;
        left: 5px;
        position: absolute;
        top: 0;

        height: $attachment-panel-height;
        line-height: $attachment-panel-height;
        z-index: -1;
      }

      .attachment-files-bitrate {
        color: #CCC;
        right: 5px;
        top: 0;
        position: absolute;

        height: $attachment-panel-height;
        line-height: $attachment-panel-height;
        z-index: -1;
      }

      .file {
        display: inline-block;
        // height: $attachment-files-height;
        background: white;
        border: 1px solid #CCC;
        margin-right: $attachment-files-padding;
        width: $attachment-file-width;
        box-sizing: border-box;
        .file-body {
          .thumbnail {
            display: block;
            background-size: cover;
            background-repeat: no-repeat;
            background-position: 0 0;
            cursor: pointer;
            width: 100%;
            height: 100%;
          }
          .file-name {
            display: block;
            // min-width: 10ex;
            // width: $attachment-file-width - $attachment-body-file-padding * 2 - $attachment-files-height - 2px;
            // float: left;
            // height: $attachment-files-height;
            line-height: $attachment-files-height - $attachment-body-file-padding * 2;
            vertical-align: middle;
            padding: (0.5*$default-gap) $default-gap;
            box-sizing: border-box;
            @include ellipsis();
            span {
              line-height: $attachment-files-height - $attachment-body-file-padding * 2;
              display: block;
              text-overflow: inherit;
              overflow: inherit;
            }
          }
        }

        .actions {
          @include float(right);
          *[data-attachment-destroy] {
            display: inline-block;
            box-sizing: border-box;
            border: none;
            text-align: center;
            background: transparent;
            padding: (0.25 * $default-gap) ($default-gap * 0.6) ;
            text-shadow: 0 0 2px #FFF;
            i {
              @include is-icon;
              @include use-icon(clear);
              color: $active-color !important;
              @include box-shadow(none);
            }
            &.loading {
              i {
                @include use-icon(spinner);
                @include animation(spin 1s infinite steps(8));
              }
            }
            &.failed {
              i {
                @include use-icon(warning);
                @include animation(spin 1s infinite steps(8));
                color: $invalid-color;
              }
            }
          }
        }
      }
    }
  }

  &.expanded {
    min-height: $attachment-full-panel-height;
    .attachments-body {
      min-height: $attachment-full-panel-height;
      .attachment-btns {
        *[data-attachments-expand] {
          i {
            @include use-icon(compress);
          }
        }
      }
      .attachment-files {
        .file {
          position: relative;
          height: $attachment-full-file-height;
          .file-body {
            width: 100%;
            height: 100%;
            .thumbnail {
              display: block;
            }
            .file-name {
              position: absolute;
              bottom: 0;
              left: 0;
              right: 0;
              background: rgba(255, 255, 255, 0.7);
              padding: 5px;
              width: 100%;
            }
          }
          .actions {
            position: absolute;
            top: 0;
            right: 0;
          }
        }
      }
    }
  }
}

[data-attachment-thumblink-target] {
  .modal-dialog {
    width: $preview-modal-width + $preview-modal-h_padding * 2;
  }

  .modal-body {
    padding: $preview-modal-v_padding $preview-modal-h_padding;
    width: $preview-modal-width;
    height: $preview-modal-height;
  }

  iframe {
    width: 100%;
    height: 100%;
    overflow: auto;
  }
}


@include keyframes(spin) {
  0% {
    @include transform(rotate(0deg));
  }
  100% {
    @include transform(rotate(359deg));
  }
}
